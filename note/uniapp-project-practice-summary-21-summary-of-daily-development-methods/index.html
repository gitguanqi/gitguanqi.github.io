<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>uniapp 项目实践总结(二十一)日常开发方法汇总 | Guan&#39;Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link href="/css/docsearch.css" rel="stylesheet">
    <link href="/css/iconfont.css" rel="stylesheet">
    <script src="/js/docsearch.js"></script>
    <script src="https://xqgj.cc/xqcdn/libs/xqgjs/mourn/mourn.min.js" id="xqmourn"></script>
    <meta name="description" content="导语：在跨端应用的日常的开发过程中|经常要用到一些全局通用方法|下面就整理一下我经常用的方法|仅供参考。
目录
路由拦截
数据处理
文本转换
禁用手势
缓存管理
权限列表
系统通知
案例展示
路由拦截
主要是uni.addInterceptor添加拦截器和uni.removeInterceptor移除拦截 ...">
    
    <link rel="preload" href="/assets/css/0.styles.d6ae6ff0.css" as="style"><link rel="preload" href="/assets/js/app.5ea0c819.js" as="script"><link rel="preload" href="/assets/js/4.5225e1f1.js" as="script"><link rel="preload" href="/assets/js/1.42b4752f.js" as="script"><link rel="preload" href="/assets/js/135.3d5f346a.js" as="script"><link rel="prefetch" href="/assets/js/100.632988dd.js"><link rel="prefetch" href="/assets/js/101.7faeea03.js"><link rel="prefetch" href="/assets/js/102.39eec660.js"><link rel="prefetch" href="/assets/js/103.62a02c4f.js"><link rel="prefetch" href="/assets/js/104.93d23ced.js"><link rel="prefetch" href="/assets/js/105.af1a4cb9.js"><link rel="prefetch" href="/assets/js/106.ba000369.js"><link rel="prefetch" href="/assets/js/107.aaa4479c.js"><link rel="prefetch" href="/assets/js/108.6ddc6cc2.js"><link rel="prefetch" href="/assets/js/109.33fc5bae.js"><link rel="prefetch" href="/assets/js/11.416e5dc4.js"><link rel="prefetch" href="/assets/js/110.18095850.js"><link rel="prefetch" href="/assets/js/111.e1265503.js"><link rel="prefetch" href="/assets/js/112.c6de75f6.js"><link rel="prefetch" href="/assets/js/113.a6a5ed73.js"><link rel="prefetch" href="/assets/js/114.5084a821.js"><link rel="prefetch" href="/assets/js/115.730ed21d.js"><link rel="prefetch" href="/assets/js/116.28195e9c.js"><link rel="prefetch" href="/assets/js/117.e890bb59.js"><link rel="prefetch" href="/assets/js/118.b15f8ab1.js"><link rel="prefetch" href="/assets/js/119.f9ab11de.js"><link rel="prefetch" href="/assets/js/12.ed5a4243.js"><link rel="prefetch" href="/assets/js/120.b3d1ce4a.js"><link rel="prefetch" href="/assets/js/121.0b77da67.js"><link rel="prefetch" href="/assets/js/122.a9ce0356.js"><link rel="prefetch" href="/assets/js/123.f327f75d.js"><link rel="prefetch" href="/assets/js/124.be639074.js"><link rel="prefetch" href="/assets/js/125.cd501567.js"><link rel="prefetch" href="/assets/js/126.3a2629b4.js"><link rel="prefetch" href="/assets/js/127.356cd46f.js"><link rel="prefetch" href="/assets/js/128.f5bbd0ad.js"><link rel="prefetch" href="/assets/js/129.c92a3a78.js"><link rel="prefetch" href="/assets/js/13.07f0df8a.js"><link rel="prefetch" href="/assets/js/130.f5949705.js"><link rel="prefetch" href="/assets/js/131.819f8918.js"><link rel="prefetch" href="/assets/js/132.8a1b7b3a.js"><link rel="prefetch" href="/assets/js/133.abf90b42.js"><link rel="prefetch" href="/assets/js/134.12b2dad0.js"><link rel="prefetch" href="/assets/js/136.b4770e06.js"><link rel="prefetch" href="/assets/js/137.3f0b5279.js"><link rel="prefetch" href="/assets/js/138.aca9250c.js"><link rel="prefetch" href="/assets/js/139.338ac567.js"><link rel="prefetch" href="/assets/js/14.4e824c70.js"><link rel="prefetch" href="/assets/js/140.5367ad85.js"><link rel="prefetch" href="/assets/js/141.3d0eae43.js"><link rel="prefetch" href="/assets/js/142.3171421e.js"><link rel="prefetch" href="/assets/js/143.6b55d976.js"><link rel="prefetch" href="/assets/js/144.d5338461.js"><link rel="prefetch" href="/assets/js/145.9dfc2bc6.js"><link rel="prefetch" href="/assets/js/146.30888306.js"><link rel="prefetch" href="/assets/js/147.92460617.js"><link rel="prefetch" href="/assets/js/148.545f7aa3.js"><link rel="prefetch" href="/assets/js/149.47088e4e.js"><link rel="prefetch" href="/assets/js/15.7efdfe54.js"><link rel="prefetch" href="/assets/js/150.a0485202.js"><link rel="prefetch" href="/assets/js/151.c073bb47.js"><link rel="prefetch" href="/assets/js/152.dbeec986.js"><link rel="prefetch" href="/assets/js/153.a172a183.js"><link rel="prefetch" href="/assets/js/154.c5e43883.js"><link rel="prefetch" href="/assets/js/155.da751479.js"><link rel="prefetch" href="/assets/js/156.008a12a2.js"><link rel="prefetch" href="/assets/js/157.9f499829.js"><link rel="prefetch" href="/assets/js/158.c7db4e64.js"><link rel="prefetch" href="/assets/js/159.0c80c60a.js"><link rel="prefetch" href="/assets/js/16.5b9d7b14.js"><link rel="prefetch" href="/assets/js/160.5e735af2.js"><link rel="prefetch" href="/assets/js/161.821eca0e.js"><link rel="prefetch" href="/assets/js/162.d74cf198.js"><link rel="prefetch" href="/assets/js/163.7d734a07.js"><link rel="prefetch" href="/assets/js/164.317c05da.js"><link rel="prefetch" href="/assets/js/17.24d0e448.js"><link rel="prefetch" href="/assets/js/18.9518b372.js"><link rel="prefetch" href="/assets/js/19.e37c08c9.js"><link rel="prefetch" href="/assets/js/2.d702e688.js"><link rel="prefetch" href="/assets/js/20.1f862e07.js"><link rel="prefetch" href="/assets/js/21.17fd406d.js"><link rel="prefetch" href="/assets/js/22.af9921e9.js"><link rel="prefetch" href="/assets/js/23.a22dbbd7.js"><link rel="prefetch" href="/assets/js/24.95561136.js"><link rel="prefetch" href="/assets/js/25.819c3e1d.js"><link rel="prefetch" href="/assets/js/26.d2b452cc.js"><link rel="prefetch" href="/assets/js/27.1cc82936.js"><link rel="prefetch" href="/assets/js/28.b1318586.js"><link rel="prefetch" href="/assets/js/29.cc5abacf.js"><link rel="prefetch" href="/assets/js/3.c8572216.js"><link rel="prefetch" href="/assets/js/30.6327abbf.js"><link rel="prefetch" href="/assets/js/31.e771166f.js"><link rel="prefetch" href="/assets/js/32.9c299618.js"><link rel="prefetch" href="/assets/js/33.f3e8f13e.js"><link rel="prefetch" href="/assets/js/34.d3c4d7c1.js"><link rel="prefetch" href="/assets/js/35.abcf6b36.js"><link rel="prefetch" href="/assets/js/36.e307bc7d.js"><link rel="prefetch" href="/assets/js/37.205b7881.js"><link rel="prefetch" href="/assets/js/38.8f796801.js"><link rel="prefetch" href="/assets/js/39.3572837d.js"><link rel="prefetch" href="/assets/js/40.2d37a7cd.js"><link rel="prefetch" href="/assets/js/41.abdd82f6.js"><link rel="prefetch" href="/assets/js/42.6c393250.js"><link rel="prefetch" href="/assets/js/43.82fc618a.js"><link rel="prefetch" href="/assets/js/44.b7fab937.js"><link rel="prefetch" href="/assets/js/45.5ab31774.js"><link rel="prefetch" href="/assets/js/46.3e320764.js"><link rel="prefetch" href="/assets/js/47.d4f79c6d.js"><link rel="prefetch" href="/assets/js/48.b8c1c50f.js"><link rel="prefetch" href="/assets/js/49.4b7265a8.js"><link rel="prefetch" href="/assets/js/5.165bd693.js"><link rel="prefetch" href="/assets/js/50.0e3063ba.js"><link rel="prefetch" href="/assets/js/51.a3396ce6.js"><link rel="prefetch" href="/assets/js/52.827f50ff.js"><link rel="prefetch" href="/assets/js/53.5cae8217.js"><link rel="prefetch" href="/assets/js/54.b0c2603c.js"><link rel="prefetch" href="/assets/js/55.c259f826.js"><link rel="prefetch" href="/assets/js/56.6508cce7.js"><link rel="prefetch" href="/assets/js/57.4a19bd53.js"><link rel="prefetch" href="/assets/js/58.60699ec3.js"><link rel="prefetch" href="/assets/js/59.6b3b09b0.js"><link rel="prefetch" href="/assets/js/6.da95428c.js"><link rel="prefetch" href="/assets/js/60.85d4a53a.js"><link rel="prefetch" href="/assets/js/61.f6ae2d14.js"><link rel="prefetch" href="/assets/js/62.d7a11faa.js"><link rel="prefetch" href="/assets/js/63.2a895a21.js"><link rel="prefetch" href="/assets/js/64.44588dfc.js"><link rel="prefetch" href="/assets/js/65.202e1932.js"><link rel="prefetch" href="/assets/js/66.2bb6e6fb.js"><link rel="prefetch" href="/assets/js/67.a1efb7aa.js"><link rel="prefetch" href="/assets/js/68.bff24c5a.js"><link rel="prefetch" href="/assets/js/69.2d81e7d3.js"><link rel="prefetch" href="/assets/js/7.07c96364.js"><link rel="prefetch" href="/assets/js/70.e5bebc56.js"><link rel="prefetch" href="/assets/js/71.d30b70cb.js"><link rel="prefetch" href="/assets/js/72.bea09996.js"><link rel="prefetch" href="/assets/js/73.c1020a3a.js"><link rel="prefetch" href="/assets/js/74.f14bd686.js"><link rel="prefetch" href="/assets/js/75.92a67f4d.js"><link rel="prefetch" href="/assets/js/76.a22d9e1e.js"><link rel="prefetch" href="/assets/js/77.7dd31a5a.js"><link rel="prefetch" href="/assets/js/78.70ad498e.js"><link rel="prefetch" href="/assets/js/79.13b144dd.js"><link rel="prefetch" href="/assets/js/8.41144950.js"><link rel="prefetch" href="/assets/js/80.1365e63c.js"><link rel="prefetch" href="/assets/js/81.289f8cc0.js"><link rel="prefetch" href="/assets/js/82.0a1002c9.js"><link rel="prefetch" href="/assets/js/83.75c23d59.js"><link rel="prefetch" href="/assets/js/84.07504837.js"><link rel="prefetch" href="/assets/js/85.8804c97d.js"><link rel="prefetch" href="/assets/js/86.9c417ca3.js"><link rel="prefetch" href="/assets/js/87.b8a1f0e9.js"><link rel="prefetch" href="/assets/js/88.576c7473.js"><link rel="prefetch" href="/assets/js/89.565390ff.js"><link rel="prefetch" href="/assets/js/90.f69f0c67.js"><link rel="prefetch" href="/assets/js/91.115da00f.js"><link rel="prefetch" href="/assets/js/92.c018f032.js"><link rel="prefetch" href="/assets/js/93.32b30cd0.js"><link rel="prefetch" href="/assets/js/94.f3783d3d.js"><link rel="prefetch" href="/assets/js/95.e5dfde0d.js"><link rel="prefetch" href="/assets/js/96.40da2f40.js"><link rel="prefetch" href="/assets/js/97.38ac6167.js"><link rel="prefetch" href="/assets/js/98.b92fe562.js"><link rel="prefetch" href="/assets/js/99.4872445a.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.42002525.js">
    <link rel="stylesheet" href="/assets/css/0.styles.d6ae6ff0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/" class="nav-link home-link">Guan'Blog </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="/" class="nav-link">主页</a></li><li class="nav-item"><a href="/tag/" class="nav-link">标签</a></li><li class="nav-item"><a href="/about/" class="nav-link">关于</a></li></ul> <div class="blog-rss" data-v-7168e7b5><a href="/sitemap.xml" target="_blank" title="RSS订阅" class="feed" data-v-7168e7b5><svg xmlns="http://www.w3.org/2000/svg" width="24" height="30" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss" data-v-7168e7b5><path d="M4 11a9 9 0 0 1 9 9" data-v-7168e7b5></path> <path d="M4 4a16 16 0 0 1 16 16" data-v-7168e7b5></path> <circle cx="5" cy="19" r="1" data-v-7168e7b5></circle></svg></a></div> <div id="header-search"><div class="blog-search" data-v-5f15d957></div></div></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/" class="nav-link mobile-home-link">Guan'Blog </a> <div class="mobile-header-title-right"><div id="header-mobile-search"><div class="blog-search" data-v-5f15d957></div></div> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="/" class="nav-link">主页</a></li><li class="mobile-nav-item"><a href="/tag/" class="nav-link">标签</a></li><li class="mobile-nav-item"><a href="/about/" class="nav-link">关于</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div id="vuepress-theme-blog__post-layout"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="vuepress-blog-theme-content"><header><h1 itemprop="name headline" class="post-title">
        uniapp 项目实践总结(二十一)日常开发方法汇总
      </h1> <div class="post-meta"><div itemprop="publisher author" itemtype="http://schema.org/Person" itemscope="itemscope" class="post-meta-author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-navigation"><polygon points="3 11 22 2 13 21 11 13 3 11"></polygon></svg> <span itemprop="name">Mark</span> <span itemprop="address">   in Jincheng</span></div> <div class="post-meta-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg> <time pubdate itemprop="datePublished" datetime="2023-09-24T11:59:20.000Z">
      2023-09-24
    </time></div> <ul itemprop="keywords" class="post-meta-tags"><li class="post-tag" data-v-93dfd07c><a href="/tag/uniapp" data-v-93dfd07c><span data-v-93dfd07c>uniapp</span></a></li></ul></div></header> <div itemprop="articleBody" class="content__default"><blockquote><p>导语：在跨端应用的日常的开发过程中|经常要用到一些全局通用方法|下面就整理一下我经常用的方法|仅供参考。</p></blockquote> <h2 id="目录"><a href="#目录" class="header-anchor">#</a> 目录</h2> <ul><li>路由拦截</li> <li>数据处理</li> <li>文本转换</li> <li>禁用手势</li> <li>缓存管理</li> <li>权限列表</li> <li>系统通知</li> <li>案例展示</li></ul> <h2 id="路由拦截"><a href="#路由拦截" class="header-anchor">#</a> 路由拦截</h2> <p>主要是<code>uni.addInterceptor</code>添加拦截器和<code>uni.removeInterceptor</code>移除拦截器两个 API 实现。</p> <ul><li>添加拦截器</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 添加拦截器</span>
uni<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">&quot;request/login&quot;</span><span class="token punctuation">,</span> <span class="token comment">//仅为示例|并非真实接口地址。</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 打印： {code:1,...}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

uni<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// request 触发前拼接 url</span>
    args<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string">&quot;https://www.example.com/&quot;</span> <span class="token operator">+</span> args<span class="token punctuation">.</span>url<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 请求成功后|修改code值为1</span>
    args<span class="token punctuation">.</span>data<span class="token punctuation">.</span>code <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">fail</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;interceptor-fail&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">complete</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;interceptor-complete&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

uni<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">returnValue</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 只返回 data 字段</span>
    <span class="token keyword">return</span> args<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><ul><li>删除拦截器</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code>uni<span class="token punctuation">.</span><span class="token function">removeInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;request&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>例如：检测登录</p> <ul><li>检测路由权限</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// scripts/utils.js</span>
<span class="token comment">// 检测登录</span>
<span class="token keyword">function</span> <span class="token function">checkLogin</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 登录白名单</span>
  <span class="token keyword">let</span> noLogin <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;/pages/index/open-app&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/pages/index/chat&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    result <span class="token operator">=</span> <span class="token operator">!</span>noLogin<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">,</span>
    token <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><ul><li>添加路由拦截器</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> utils <span class="token keyword">from</span> <span class="token string">&quot;./scripts/utils.js&quot;</span><span class="token punctuation">;</span>

uni<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token string">&quot;navigateTo&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> isLogin <span class="token operator">=</span> utils<span class="token punctuation">.</span><span class="token function">checkLogin</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      utils<span class="token punctuation">.</span><span class="token function">navigate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&quot;redir&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/pages/index/chat?redirectUrl=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;success:&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">fail</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;fail:&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">complete</span><span class="token punctuation">(</span><span class="token parameter">doc</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;complete:&quot;</span><span class="token punctuation">,</span> doc<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="数据处理"><a href="#数据处理" class="header-anchor">#</a> 数据处理</h2> <h3 id="敏感词过滤替换方法"><a href="#敏感词过滤替换方法" class="header-anchor">#</a> 敏感词过滤替换方法</h3> <p>有时候涉及评论等方面的内容|需要对敏感词进行过滤|下面就是一个简单的方法来检测并且过滤敏感词。</p> <ul><li>中文分词方法封装</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// /scripts/utils</span>
<span class="token keyword">function</span> <span class="token function">mineJieba</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">class</span> <span class="token class-name">WordTree</span> <span class="token punctuation">{</span>
    root <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    stop <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">你</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">我</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
      <span class="token literal-property property">它</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>root <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NodeAs</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 将unicode转成utf-8的三字节</span>
    <span class="token function">toBytes</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> word<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> code <span class="token operator">=</span> word<span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>code <span class="token operator">&lt;</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toUTF8</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">toUTF8</span><span class="token punctuation">(</span><span class="token parameter">code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> byte1 <span class="token operator">=</span> <span class="token number">0xe0</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>code <span class="token operator">&gt;&gt;</span> <span class="token number">12</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        byte2 <span class="token operator">=</span> <span class="token number">0x80</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>code <span class="token operator">&gt;&gt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        byte3 <span class="token operator">=</span> <span class="token number">0x80</span> <span class="token operator">|</span> <span class="token punctuation">(</span>code <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">[</span>byte1<span class="token punctuation">,</span> byte2<span class="token punctuation">,</span> byte3<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">toUTF16</span><span class="token punctuation">(</span><span class="token parameter">b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> byte1 <span class="token operator">=</span> <span class="token punctuation">(</span>b1 <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b2 <span class="token operator">&gt;&gt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">0x0f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        byte2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>b2 <span class="token operator">&amp;</span> <span class="token number">0x03</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">6</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token punctuation">(</span>b3 <span class="token operator">&amp;</span> <span class="token number">0x3f</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        utf16 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>byte1 <span class="token operator">&amp;</span> <span class="token number">0x00ff</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">|</span> byte2<span class="token punctuation">;</span>
      <span class="token keyword">return</span> utf16<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 添加每个词到trie</span>
    <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter">word</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span>
        bytes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">,</span>
        len <span class="token operator">=</span> bytes<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> c <span class="token operator">=</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c <span class="token keyword">in</span> node<span class="token punctuation">.</span>childs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          node<span class="token punctuation">.</span>childs<span class="token punctuation">[</span>c<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">NodeAs</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        node <span class="token operator">=</span> node<span class="token punctuation">.</span>childs<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      node<span class="token punctuation">.</span><span class="token function">asWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 按字节在trie树中搜索</span>
    <span class="token function">search</span><span class="token punctuation">(</span><span class="token parameter">bytes</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> node <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>root<span class="token punctuation">,</span>
        len <span class="token operator">=</span> bytes<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        word <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
        j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> c <span class="token operator">=</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>
          childs <span class="token operator">=</span> node<span class="token punctuation">.</span>childs<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span>c <span class="token keyword">in</span> childs<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>c <span class="token operator">&lt;</span> <span class="token number">0x80</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          word<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          j<span class="token operator">++</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">%</span> <span class="token number">3</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">let</span> b1 <span class="token operator">=</span> bytes<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              b2 <span class="token operator">=</span> bytes<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
              b3 <span class="token operator">=</span> c<span class="token punctuation">;</span>
            word<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token function">fromCharCode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toUTF16</span><span class="token punctuation">(</span>b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token keyword">this</span><span class="token punctuation">.</span>stop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> result<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">let</span> cnode <span class="token operator">=</span> childs<span class="token punctuation">[</span>c<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>cnode<span class="token punctuation">.</span><span class="token function">isWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          cnode<span class="token punctuation">.</span><span class="token function">addCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>word<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        node <span class="token operator">=</span> cnode<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 分词</span>
    <span class="token function">splitWords</span><span class="token punctuation">(</span><span class="token parameter">words</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> bytes <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">toBytes</span><span class="token punctuation">(</span>words<span class="token punctuation">)</span><span class="token punctuation">,</span>
        start <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span>
        end <span class="token operator">=</span> bytes<span class="token punctuation">.</span>length<span class="token punctuation">,</span>
        result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">while</span> <span class="token punctuation">(</span>start <span class="token operator">!=</span> end<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> word <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> start<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> end<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> b <span class="token operator">=</span> bytes<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
          word<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> finds <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">search</span><span class="token punctuation">(</span>word<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>finds <span class="token operator">!=</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> finds<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            result <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>finds<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        start<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 初始化</span>
    <span class="token function">init</span><span class="token punctuation">(</span><span class="token parameter">dict</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> dict<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>dict<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">class</span> <span class="token class-name">NodeAs</span> <span class="token punctuation">{</span>
    childs <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    _byte <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    _isWord <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    _count <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>childs <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_byte <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_byte <span class="token operator">||</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_isWord <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">isWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_isWord <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">asWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_isWord <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">addCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>_count<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>_count<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">let</span> mjb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WordTree</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> mjb<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br></div></div><ul><li>敏感词检测示例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 检测信息</span>
<span class="token keyword">const</span> words <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">str</span><span class="token operator">:</span> <span class="token string">&quot;我是一只小蜜蜂！&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dict</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;蜜蜂&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">res</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 开始分词</span>
<span class="token keyword">function</span> <span class="token function">startWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> mineJieba <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>mineJieba<span class="token punctuation">;</span>
  <span class="token keyword">let</span> mjb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mineJieba</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  mjb<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span>dict<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> mjb<span class="token punctuation">.</span><span class="token function">splitWords</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
  words<span class="token punctuation">.</span>res <span class="token operator">=</span> res<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token string">&quot;暂无敏感词&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;含有敏感词&quot;</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>words<span class="token punctuation">.</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 含有敏感词</span>
<span class="token punctuation">}</span>
<span class="token function">startWord</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="js-打字效果实现"><a href="#js-打字效果实现" class="header-anchor">#</a> JS 打字效果实现</h3> <ul><li>页面内容</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>startTyping<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>开始打字<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span> 打字效果： <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>typing<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ typeInfo.result }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>页面样式</li></ul> <div class="language-css line-numbers-mode"><pre class="language-css"><code><span class="token selector">.typing</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> #d32d2d<span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> 1em<span class="token punctuation">;</span>
  <span class="token property">line-height</span><span class="token punctuation">:</span> 1.5<span class="token punctuation">;</span>
  <span class="token property">word-break</span><span class="token punctuation">:</span> break-all<span class="token punctuation">;</span>
  <span class="token property">text-transform</span><span class="token punctuation">:</span> uppercase<span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> left<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>打字方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 定义数据</span>
<span class="token keyword">const</span> typeInfo <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;物理层负责最后将信息编码成电流脉冲或其它信号用于网上传输。它由计算机和网络介质之间的实际界面组成|可定义电气信号、符号、线的状态和时钟要求、数据编码和数据传输用的连接器。&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">index</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">result</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 开始打字</span>
<span class="token keyword">function</span> <span class="token function">startTyping</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>typeInfo<span class="token punctuation">.</span>index <span class="token operator">&lt;</span> typeInfo<span class="token punctuation">.</span>text<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    typeInfo<span class="token punctuation">.</span>result <span class="token operator">=</span> typeInfo<span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> typeInfo<span class="token punctuation">.</span>index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;_&quot;</span><span class="token punctuation">;</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span>startTyping<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    typeInfo<span class="token punctuation">.</span>result <span class="token operator">=</span> typeInfo<span class="token punctuation">.</span>text<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h3 id="获取-dom-元素"><a href="#获取-dom-元素" class="header-anchor">#</a> 获取 DOM 元素</h3> <ul><li>方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getDom</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> domAll <span class="token operator">=</span> uni
      <span class="token punctuation">.</span><span class="token function">createSelectorQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">selectAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">boundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>示例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token keyword">await</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">getDom</span><span class="token punctuation">(</span><span class="token string">&quot;.typing&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
[
    [
        {
            &quot;id&quot;: &quot;&quot;,
            &quot;dataset&quot;: {
                &quot;vB492ef87&quot;: &quot;&quot;
            },
            &quot;left&quot;: 20,
            &quot;right&quot;: 355,
            &quot;top&quot;: 261,
            &quot;bottom&quot;: 261,
            &quot;width&quot;: 335,
            &quot;height&quot;: 0
        }
    ]
]
*/</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="文本转换"><a href="#文本转换" class="header-anchor">#</a> 文本转换</h2> <h3 id="html-标签转为文本"><a href="#html-标签转为文本" class="header-anchor">#</a> html 标签转为文本</h3> <ul><li>方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">TagToText</span><span class="token punctuation">(</span><span class="token parameter">html</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> reg <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">(&lt;([^&gt;]+)&gt;)</span><span class="token regex-delimiter">/</span><span class="token regex-flags">gi</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> html<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>reg<span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>示例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> str <span class="token operator">=</span> <span class="token string">&quot;&lt;div&gt;&lt;h2&gt;Hello&lt;/h2&gt;&lt;p&gt;这里是标签转文本的内容!&lt;/p&gt;&lt;/div&gt;&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> res <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">tagToText</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Hello这里是标签转文本的内容!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="生成-uuid"><a href="#生成-uuid" class="header-anchor">#</a> 生成 uuid</h3> <ul><li>方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 生成唯一id</span>
<span class="token keyword">function</span> <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> timestamp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    randomStr <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token operator">*</span> Math<span class="token punctuation">.</span><span class="token function">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>timestamp<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>randomStr<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>示例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> id <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 18ac0fc0bb213nevk5f0ps</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="复制文本"><a href="#复制文本" class="header-anchor">#</a> 复制文本</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 复制文本</span>
<span class="token keyword">function</span> <span class="token function">copyText</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// #ifdef H5</span>
  <span class="token keyword">let</span> ipt <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;input&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ipt<span class="token punctuation">.</span>value <span class="token operator">=</span> text<span class="token punctuation">;</span>
  ipt<span class="token punctuation">.</span>readOnly <span class="token operator">=</span> <span class="token string">&quot;readOnly&quot;</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>ipt<span class="token punctuation">)</span><span class="token punctuation">;</span>
  ipt<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ipt<span class="token punctuation">.</span><span class="token function">setSelectionRange</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> text<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
  uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;复制成功！&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  document<span class="token punctuation">.</span><span class="token function">execCommand</span><span class="token punctuation">(</span><span class="token string">&quot;copy&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ipt<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// #endif</span>
  <span class="token comment">// #ifndef H5</span>
  uni<span class="token punctuation">.</span><span class="token function">setClipboardData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> text<span class="token punctuation">,</span>
    <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;复制成功！&quot;</span><span class="token punctuation">,</span>
        <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// #endif</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h3 id="是否-json"><a href="#是否-json" class="header-anchor">#</a> 是否 JSON</h3> <ul><li>方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 是否json格式</span>
<span class="token keyword">function</span> <span class="token function">isJson</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> res <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> str <span class="token operator">==</span> <span class="token string">&quot;string&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>str<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>示例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> json1 <span class="token operator">=</span> <span class="token string">&quot;who&quot;</span><span class="token punctuation">,</span>
  json2 <span class="token operator">=</span> <span class="token string">'{&quot;id&quot;:1,&quot;name&quot;:&quot;mark&quot;}'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">isJson</span><span class="token punctuation">(</span>json1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">isJson</span><span class="token punctuation">(</span>json2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>时间友好化</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">firendDate</span><span class="token punctuation">(</span>time <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> now <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 当前时间</span>
    newTime <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 参数时间</span>
    diff <span class="token operator">=</span> <span class="token punctuation">(</span>now <span class="token operator">-</span> newTime<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span> <span class="token comment">// 时间差值</span>
  <span class="token keyword">let</span> numberList <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token number">60</span><span class="token punctuation">,</span> <span class="token comment">// 超过1分钟</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token comment">// 超过1小时</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token comment">// 超过1天</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token comment">// 超过1月</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">365</span><span class="token punctuation">,</span> <span class="token comment">// 超过1年</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">365</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 超过1个世纪</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">365</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token comment">// 超过1千年</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">365</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token comment">// 超过1万年</span>
    <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span> <span class="token operator">*</span> <span class="token number">365</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">100</span> <span class="token operator">*</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token comment">// 超过1亿年</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> index<span class="token punctuation">,</span> number<span class="token punctuation">,</span> result<span class="token punctuation">;</span> <span class="token comment">// 类型|数值|结果</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> numberList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>diff <span class="token operator">&lt;</span> numberList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      index <span class="token operator">=</span> i<span class="token punctuation">;</span>
      number <span class="token operator">=</span> i <span class="token operator">===</span> <span class="token number">0</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> diff <span class="token operator">/</span> numberList<span class="token punctuation">[</span>i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  number <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>number<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> types <span class="token operator">=</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;刚刚&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;分钟前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;小时前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;天前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;月前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;年前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;世纪前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;千年前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;万年前&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;亿年前&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">;</span>
  result <span class="token operator">=</span> index <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">?</span> types<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>number<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>types<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> time1 <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">firendDate</span><span class="token punctuation">(</span><span class="token string">&quot;2023-09-23 16:12:12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  time2 <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">firendDate</span><span class="token punctuation">(</span><span class="token string">&quot;2023-09-22 11:12:12&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  time3 <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">firendDate</span><span class="token punctuation">(</span><span class="token string">&quot;2022-11-23 11:22:24&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>time1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 刚刚</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>time2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1天前</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>time3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 10月前</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>计算文件大小</li></ul> <p>参数单位是 <code>B</code></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">fileSize</span><span class="token punctuation">(</span><span class="token parameter">size <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">typeof</span> size <span class="token operator">!=</span> <span class="token string">&quot;number&quot;</span> <span class="token operator">?</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span> <span class="token operator">:</span> size<span class="token punctuation">,</span>
    sizes <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">b</span><span class="token operator">:</span> <span class="token number">1024</span><span class="token punctuation">,</span>
      <span class="token literal-property property">kb</span><span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
      <span class="token literal-property property">mb</span><span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
      <span class="token literal-property property">gb</span><span class="token operator">:</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span> <span class="token operator">*</span> <span class="token number">1024</span><span class="token punctuation">,</span>
      <span class="token function">toSize</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> unit <span class="token operator">=</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> val <span class="token operator">=</span> <span class="token punctuation">(</span>size <span class="token operator">/</span> <span class="token keyword">this</span><span class="token punctuation">[</span>type<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>val<span class="token interpolation-punctuation punctuation">}</span></span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>unit<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token string">&quot;0B&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> sizes<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">B</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> sizes<span class="token punctuation">.</span>kb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> sizes<span class="token punctuation">.</span><span class="token function">toSize</span><span class="token punctuation">(</span><span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;kb&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>result <span class="token operator">&lt;</span> sizes<span class="token punctuation">.</span>mb<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> sizes<span class="token punctuation">.</span><span class="token function">toSize</span><span class="token punctuation">(</span><span class="token string">&quot;kb&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mb&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    result <span class="token operator">=</span> sizes<span class="token punctuation">.</span><span class="token function">toSize</span><span class="token punctuation">(</span><span class="token string">&quot;mb&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;gb&quot;</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> result<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> size1 <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">fileSize</span><span class="token punctuation">(</span><span class="token number">20223123</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  size2 <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">fileSize</span><span class="token punctuation">(</span><span class="token number">2022312323</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  size3 <span class="token operator">=</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">fileSize</span><span class="token punctuation">(</span><span class="token number">2022</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>size1<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 19.29MB</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>size2<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1.88GB</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>size3<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 1.97KB</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="禁用手势"><a href="#禁用手势" class="header-anchor">#</a> 禁用手势</h2> <p>下面是常用的禁用手势的一些方法|可能会有一些兼容性错误。</p> <h3 id="页面设置"><a href="#页面设置" class="header-anchor">#</a> 页面设置</h3> <ul><li>1.uni 设置</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// #ifdef APP-PLUS</span>
<span class="token keyword">let</span> page <span class="token operator">=</span> uni<span class="token punctuation">.</span><span class="token function">getAppWebview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
page<span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">popGesture</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// #endif</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>2.plus 设置</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// #ifdef APP-PLUS</span>
plus<span class="token punctuation">.</span>webview<span class="token punctuation">.</span><span class="token function">currentWebview</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStyle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">popGesture</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// #endif</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="配置设置"><a href="#配置设置" class="header-anchor">#</a> 配置设置</h3> <p>在<code>pages.json</code>中添加</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pages/index/index&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;style&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">&quot;navigationBarTitleText&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">,</span>
        <span class="token property">&quot;app-plus&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
          <span class="token property">&quot;popGesture&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h3 id="全局设置"><a href="#全局设置" class="header-anchor">#</a> 全局设置</h3> <p>在<code>manifest</code>源码视图中添加：</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;app-plus&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;popGesture&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="事件控制"><a href="#事件控制" class="header-anchor">#</a> 事件控制</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">onBackPress</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>options<span class="token punctuation">.</span>from <span class="token operator">===</span> <span class="token string">&quot;navigateBack&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  uni<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/pages/index/index'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="系统通知"><a href="#系统通知" class="header-anchor">#</a> 系统通知</h2> <ul><li>方法</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 通知消息</span>
<span class="token keyword">function</span> <span class="token function">sendNotify</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;系统通知&quot;</span><span class="token punctuation">,</span> content <span class="token operator">=</span> <span class="token string">&quot;系统通知的内容!&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// #ifdef H5</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>Notification<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    Notification<span class="token punctuation">.</span><span class="token function">requestPermission</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>res <span class="token operator">==</span> <span class="token string">&quot;granted&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> notify <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Notification</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token punctuation">{</span>
          <span class="token literal-property property">body</span><span class="token operator">:</span> content<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        notify<span class="token punctuation">.</span><span class="token function-variable function">onshow</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;通知已显示！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        notify<span class="token punctuation">.</span><span class="token function-variable function">onclick</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;通知已点击！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        notify<span class="token punctuation">.</span><span class="token function-variable function">onclose</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;通知已关闭！&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        notify<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;通知失败&quot;</span><span class="token punctuation">,</span>
            <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;notify:&quot;</span><span class="token punctuation">,</span> notify<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;已拒绝!&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;操作失败!&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// #endif</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br></div></div><ul><li>示例</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> title <span class="token operator">=</span> <span class="token string">&quot;系统消息&quot;</span><span class="token punctuation">,</span>
  content <span class="token operator">=</span> <span class="token string">&quot;Hello,Mark&quot;</span><span class="token punctuation">;</span>
proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span><span class="token function">sendNotify</span><span class="token punctuation">(</span>title<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="缓存管理"><a href="#缓存管理" class="header-anchor">#</a> 缓存管理</h2> <h3 id="获取清除方法"><a href="#获取清除方法" class="header-anchor">#</a> 获取清除方法</h3> <ul><li>获取缓存</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// #ifdef APP-PLUS</span>
<span class="token keyword">function</span> <span class="token function">getCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      plus<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">calculate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">size</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> cacheSize <span class="token operator">=</span> <span class="token function">fileSize</span><span class="token punctuation">(</span>size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">code</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
          <span class="token literal-property property">data</span><span class="token operator">:</span> cacheSize<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// #endif</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>清除应用缓存</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// #ifdef APP-PLUS</span>
<span class="token keyword">function</span> <span class="token function">clearCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>plus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> os <span class="token operator">=</span> plus<span class="token punctuation">.</span>os<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>os <span class="token operator">==</span> <span class="token string">&quot;Android&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> main <span class="token operator">=</span> plus<span class="token punctuation">.</span>android<span class="token punctuation">.</span><span class="token function">runtimeMainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> sdRoot <span class="token operator">=</span> main<span class="token punctuation">.</span><span class="token function">getCacheDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> files <span class="token operator">=</span> plus<span class="token punctuation">.</span>android<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>sdRoot<span class="token punctuation">,</span> <span class="token string">&quot;listFiles&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">let</span> len <span class="token operator">=</span> files<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> filePath <span class="token operator">=</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> files<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        plus<span class="token punctuation">.</span>io<span class="token punctuation">.</span><span class="token function">resolveLocalFileSystemURL</span><span class="token punctuation">(</span>
          filePath<span class="token punctuation">,</span>
          <span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>entry<span class="token punctuation">.</span>isDirectory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
              entry<span class="token punctuation">.</span><span class="token function">removeRecursively</span><span class="token punctuation">(</span>
                <span class="token punctuation">(</span><span class="token parameter">entrys</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                  files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;清除失败:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
              <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
              entry<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;清除失败:&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      plus<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;清除成功!&quot;</span><span class="token punctuation">,</span>
          <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// #endif</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div><ul><li>清除全部缓存</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// #ifdef APP-PLUS</span>
<span class="token keyword">function</span> <span class="token function">clearAllCache</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  plus<span class="token punctuation">.</span>android<span class="token punctuation">.</span><span class="token function">importClass</span><span class="token punctuation">(</span><span class="token string">&quot;android.app.ActivityManager&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> context <span class="token operator">=</span> plus<span class="token punctuation">.</span>android<span class="token punctuation">.</span><span class="token function">importClass</span><span class="token punctuation">(</span><span class="token string">&quot;android.content.Context&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> am <span class="token operator">=</span> plus<span class="token punctuation">.</span>android
    <span class="token punctuation">.</span><span class="token function">runtimeMainActivity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token constant">ACTIVITY_SERVICE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  am<span class="token punctuation">.</span><span class="token function">clearApplicationUserData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  uni<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">title</span><span class="token operator">:</span> <span class="token string">&quot;清除成功!&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">icon</span><span class="token operator">:</span> <span class="token string">&quot;success&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// #endif</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h3 id="缓存案例展示"><a href="#缓存案例展示" class="header-anchor">#</a> 缓存案例展示</h3> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- #ifdef APP-PLUS --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>template-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getCache<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>获取缓存<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>template-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clearCache('app')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>清除应用缓存<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>template-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>default<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clearCache('all')<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>清除全部缓存<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- #endif --&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// #ifdef APP-PLUS</span>
<span class="token comment">// 获取缓存</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getCache</span><span class="token punctuation">(</span>$event<span class="token punctuation">,</span> from <span class="token operator">=</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> cacheSize <span class="token operator">=</span> <span class="token keyword">await</span> proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">应用缓存大小(</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token keyword">from</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">):, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>cacheSize<span class="token punctuation">.</span>data<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 应用缓存大小(app):, 1.15KB 应用缓存大小(app):, 0B</span>
<span class="token punctuation">}</span>

<span class="token comment">// 清除缓存</span>
<span class="token keyword">function</span> <span class="token function">clearCache</span><span class="token punctuation">(</span>type <span class="token operator">=</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token string">&quot;app&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">del</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    proxy<span class="token punctuation">.</span>$apis<span class="token punctuation">.</span>utils<span class="token punctuation">.</span>cache<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getCache</span><span class="token punctuation">(</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// #endif</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="权限列表"><a href="#权限列表" class="header-anchor">#</a> 权限列表</h2> <table><thead><tr><th>权限名称</th> <th>权限属性</th> <th>权限描述</th></tr></thead> <tbody><tr><td>访问登记属性</td> <td>android.permission.ACCESS_CHECKIN_PROPERTIES</td> <td>读取或写入登记 check-in 数据库属性表的权限</td></tr> <tr><td>获取错略位置</td> <td>android.permission.ACCESS_COARSE_LOCATION</td> <td>通过 WiFi 或移动基站的方式获取用户错略的经纬度信息</td></tr> <tr><td>获取精确位置</td> <td>android.permission.ACCESS_FINE_LOCATION</td> <td>通过 GPS 芯片接收卫星的定位信息</td></tr> <tr><td>访问定位额外命令</td> <td>android.permission.ACCESS_LOCATION_EXTRA_COMMANDS</td> <td>允许程序访问额外的定位提供者指令</td></tr> <tr><td>获取模拟定位信息</td> <td>android.permission.ACCESS_MOCK_LOCATION</td> <td>获取模拟定位信息</td></tr> <tr><td>获取网络状态</td> <td>android.permission.ACCESS_NETWORK_STATE</td> <td>获取网络信息状态</td></tr> <tr><td>访问 Surface Flinger</td> <td>android.permission.ACCESS_SURFACE_FLINGER</td> <td>Android 平台上底层的图形显示支持</td></tr> <tr><td>获取 WiFi 状态</td> <td>android.permission.ACCESS_WIFI_STATE</td> <td>获取当前 WiFi 接入的状态以及 WLAN 热点的信息</td></tr> <tr><td>账户管理</td> <td>android.permission.ACCOUNT_MANAGER</td> <td>获取账户验证信息</td></tr> <tr><td>验证账户</td> <td>android.permission.AUTHENTICATE_ACCOUNTS</td> <td>允许一个程序通过账户验证方式访问账户管理 ACCOUNT_MANAGER 相关信息</td></tr> <tr><td>电量统计</td> <td>android.permission.BATTERY_STATS</td> <td>获取电池电量统计信息</td></tr> <tr><td>绑定小插件</td> <td>android.permission.BIND_APPWIDGET</td> <td>允许一个程序告诉 appWidget 服务需要访问小插件的数据库</td></tr> <tr><td>绑定设备管理</td> <td>android.permission.BIND_DEVICE_ADMIN</td> <td>请求系统管理员接收者 receiver</td></tr> <tr><td>绑定输入法</td> <td>android.permission.BIND_INPUT_METHOD</td> <td>请求 InputMethodService 服务</td></tr> <tr><td>绑定 RemoteView</td> <td>android.permission.BIND_REMOTEVIEWS</td> <td>必须通过 RemoteViewsService 服务来请求</td></tr> <tr><td>绑定壁纸</td> <td>android.permission.BIND_WALLPAPER</td> <td>必须通过 WallpaperService 服务来请求</td></tr> <tr><td>使用蓝牙</td> <td>android.permission.BLUETOOTH</td> <td>允许程序连接配对过的蓝牙设备</td></tr> <tr><td>蓝牙管理</td> <td>android.permission.BLUETOOTH_ADMIN</td> <td>允许程序进行发现和配对新的蓝牙设备</td></tr> <tr><td>变成砖头</td> <td>android.permission.BRICK</td> <td>能够禁用手机</td></tr> <tr><td>应用删除时广播</td> <td>android.permission.BROADCAST_PACKAGE_REMOVED</td> <td>当一个应用在删除时触发一个广播</td></tr> <tr><td>收到短信时广播</td> <td>android.permission.BROADCAST_SMS</td> <td>当收到短信时触发一个广播</td></tr> <tr><td>连续广播</td> <td>android.permission.BROADCAST_STICKY</td> <td>允许一个程序收到广播后快速收到下一个广播</td></tr> <tr><td>WAP PUSH 广播</td> <td>android.permission.BROADCAST_WAP_PUSH</td> <td>WAP PUSH 服务收到后触发一个广播</td></tr> <tr><td>拨打电话</td> <td>android.permission.CALL_PHONE</td> <td>允许程序从非系统拨号器里输入电话号码</td></tr> <tr><td>通话权限</td> <td>android.permission.CALL_PRIVILEGED</td> <td>允许程序拨打电话</td></tr> <tr><td>拍照权限</td> <td>android.permission.CAMERA</td> <td>允许访问摄像头进行拍照</td></tr> <tr><td>改变组件状态</td> <td>android.permission.CHANGE_COMPONENT_ENABLED_STATE</td> <td>改变组件是否启用状态</td></tr> <tr><td>改变配置</td> <td>android.permission.CHANGE_CONFIGURATION</td> <td>允许当前应用改变配置</td></tr> <tr><td>改变网络状态</td> <td>android.permission.CHANGE_NETWORK_STATE</td> <td>改变网络状态如是否能联网</td></tr> <tr><td>改变 WiFi 多播状态</td> <td>android.permission.CHANGE_WIFI_MULTICAST_STATE</td> <td>改变 WiFi 多播状态</td></tr> <tr><td>改变 WiFi 状态</td> <td>android.permission.CHANGE_WIFI_STATE</td> <td>改变 WiFi 状态</td></tr> <tr><td>清除应用缓存</td> <td>android.permission.CLEAR_APP_CACHE</td> <td>清除应用缓存</td></tr> <tr><td>清除用户数据</td> <td>android.permission.CLEAR_APP_USER_DATA</td> <td>清除应用的用户数据</td></tr> <tr><td>底层访问权限</td> <td>android.permission.CWJ_GROUP</td> <td>允许 CWJ 账户组访问底层信息</td></tr> <tr><td>手机优化大师扩展权限</td> <td>android.permission.CELL_PHONE_MASTER_EX</td> <td>手机优化大师扩展权限</td></tr> <tr><td>控制定位更新</td> <td>android.permission.CONTROL_LOCATION_UPDATES</td> <td>允许获得移动网络定位信息改变</td></tr> <tr><td>删除缓存文件</td> <td>android.permission.DELETE_CACHE_FILES</td> <td>允许应用删除缓存文件</td></tr> <tr><td>删除应用</td> <td>android.permission.DELETE_PACKAGES</td> <td>允许程序删除应用</td></tr> <tr><td>电源管理</td> <td>android.permission.DEVICE_POWER</td> <td>允许访问底层电源管理</td></tr> <tr><td>应用诊断</td> <td>android.permission.DIAGNOSTIC</td> <td>允许程序到 RW 到诊断资源</td></tr> <tr><td>禁用键盘锁</td> <td>android.permission.DISABLE_KEYGUARD</td> <td>允许程序禁用键盘锁</td></tr> <tr><td>转存系统信息</td> <td>android.permission.DUMP</td> <td>允许程序获取系统 dump 信息从系统服务</td></tr> <tr><td>状态栏控制</td> <td>android.permission.EXPAND_STATUS_BAR</td> <td>允许程序扩展或收缩状态栏</td></tr> <tr><td>工厂测试模式</td> <td>android.permission.FACTORY_TEST</td> <td>允许程序运行工厂测试模式</td></tr> <tr><td>使用闪光灯</td> <td>android.permission.FLASHLIGHT</td> <td>允许访问闪光灯</td></tr> <tr><td>强制后退</td> <td>android.permission.FORCE_BACK</td> <td>允许程序强制使用 back 后退按键</td></tr> <tr><td>访问账户 Gmail 列表</td> <td>android.permission.GET_ACCOUNTS</td> <td>访问 GMail 账户列表</td></tr> <tr><td>获取应用大小</td> <td>android.permission.GET_PACKAGE_SIZE</td> <td>获取应用的文件大小</td></tr> <tr><td>获取任务信息</td> <td>android.permission.GET_TASKS</td> <td>允许程序获取当前或最近运行的应用</td></tr> <tr><td>允许全局搜索</td> <td>android.permission.GLOBAL_SEARCH</td> <td>允许程序使用全局搜索功能</td></tr> <tr><td>硬件测试</td> <td>android.permission.HARDWARE_TEST</td> <td>访问硬件辅助设备</td></tr> <tr><td>注射事件</td> <td>android.permission.INJECT_EVENTS</td> <td>允许访问本程序的底层事件</td></tr> <tr><td>安装定位提供</td> <td>android.permission.INSTALL_LOCATION_PROVIDER</td> <td>安装定位提供</td></tr> <tr><td>安装应用程序</td> <td>android.permission.INSTALL_PACKAGES</td> <td>允许程序安装应用</td></tr> <tr><td>内部系统窗口</td> <td>android.permission.INTERNAL_SYSTEM_WINDOW</td> <td>允许程序打开内部窗口</td></tr> <tr><td>访问网络</td> <td>android.permission.INTERNET</td> <td>访问网络连接</td></tr> <tr><td>结束后台进程</td> <td>android.permission.KILL_BACKGROUND_PROCESSES</td> <td>允许程序调用 killBackgroundProcesses(String).方法结束后台进程</td></tr> <tr><td>管理账户</td> <td>android.permission.MANAGE_ACCOUNTS</td> <td>允许程序管理 AccountManager 中的账户列表</td></tr> <tr><td>管理程序引用</td> <td>android.permission.MANAGE_APP_TOKENS</td> <td>管理创建、摧毁、Z 轴顺序</td></tr> <tr><td>高级权限</td> <td>android.permission.MTWEAK_USER</td> <td>允许 mTweak 用户访问高级系统权限</td></tr> <tr><td>社区权限</td> <td>android.permission.MTWEAK_FORUM</td> <td>允许使用 mTweak 社区权限</td></tr> <tr><td>软格式化</td> <td>android.permission.MASTER_CLEAR</td> <td>允许程序执行软格式化</td></tr> <tr><td>修改声音设置</td> <td>android.permission.MODIFY_AUDIO_SETTINGS</td> <td>修改声音设置信息</td></tr> <tr><td>修改电话状态</td> <td>android.permission.MODIFY_PHONE_STATE</td> <td>修改电话状态</td></tr> <tr><td>格式化文件系统</td> <td>android.permission.MOUNT_FORMAT_FILESYSTEMS</td> <td>格式化可移动文件系统</td></tr> <tr><td>挂载文件系统</td> <td>android.permission.MOUNT_UNMOUNT_FILESYSTEMS</td> <td>挂载、反挂载外部文件系统</td></tr> <tr><td>允许 NFC 通讯</td> <td>android.permission.NFC</td> <td>允许程序执行 NFC 近距离通讯操作</td></tr> <tr><td>永久 Activity</td> <td>android.permission.PERSISTENT_ACTIVITY</td> <td>创建一个永久的 Activity</td></tr> <tr><td>处理拨出电话</td> <td>android.permission.PROCESS_OUTGOING_CALLS</td> <td>允许程序监视</td></tr> <tr><td>读取日程提醒</td> <td>android.permission.READ_CALENDAR</td> <td>允许程序读取用户的日程信息</td></tr> <tr><td>读取联系人</td> <td>android.permission.READ_CONTACTS</td> <td>允许应用访问联系人通讯录信息</td></tr> <tr><td>屏幕截图</td> <td>android.permission.READ_FRAME_BUFFER</td> <td>读取帧缓存用于屏幕截图</td></tr> <tr><td>读取收藏夹和历史记录</td> <td>android.browser.permission.READ_HISTORY_BOOKMARKS</td> <td>读取浏览器收藏夹和历史记录</td></tr> <tr><td>读取输入状态</td> <td>android.permission.READ_INPUT_STATE</td> <td>读取当前键的输入状态</td></tr> <tr><td>读取系统日志</td> <td>android.permission.READ_LOGS</td> <td>读取系统底层日志</td></tr> <tr><td>读取电话状态</td> <td>android.permission.READ_PHONE_STATE</td> <td>访问电话状态</td></tr> <tr><td>读取短信内容</td> <td>android.permission.READ_SMS</td> <td>读取短信内容</td></tr> <tr><td>读取同步设置</td> <td>android.permission.READ_SYNC_SETTINGS</td> <td>读取同步设置</td></tr> <tr><td>读取同步状态</td> <td>android.permission.READ_SYNC_STATS</td> <td>读取同步状态</td></tr> <tr><td>重启设备</td> <td>android.permission.REBOOT</td> <td>允许程序重新启动设备</td></tr> <tr><td>开机自动允许</td> <td>android.permission.RECEIVE_BOOT_COMPLETED</td> <td>允许程序开机自动运行</td></tr> <tr><td>接收彩信</td> <td>android.permission.RECEIVE_MMS</td> <td>接收彩信</td></tr> <tr><td>接收短信</td> <td>android.permission.RECEIVE_SMS</td> <td>接收短信</td></tr> <tr><td>接收 Wap Push</td> <td>android.permission.RECEIVE_WAP_PUSH</td> <td>接收 WAP PUSH 信息</td></tr> <tr><td>录音</td> <td>android.permission.RECORD_AUDIO</td> <td>录制声音通过手机或耳机的麦克</td></tr> <tr><td>排序系统任务</td> <td>android.permission.REORDER_TASKS</td> <td>重新排序系统 Z 轴运行中的任务</td></tr> <tr><td>结束系统任务</td> <td>android.permission.RESTART_PACKAGES</td> <td>结束任务通过 restartPackage(String)方法</td></tr> <tr><td>发送短信</td> <td>android.permission.SEND_SMS</td> <td>发送短信</td></tr> <tr><td>设置 Activity</td> <td>android.permission.SET_ACTIVITY_WATCHER</td> <td>设置 Activity 观察器一般用于 monkey 测试</td></tr> <tr><td>设置闹铃提醒</td> <td>android.alarm.permission.SET_ALARM</td> <td>设置闹铃提醒</td></tr> <tr><td>设置总是退出</td> <td>android.permission.SET_ALWAYS_FINISH</td> <td>设置程序在后台是否总是退出</td></tr> <tr><td>设置动画缩放</td> <td>android.permission.SET_ANIMATION_SCALE</td> <td>设置全局动画缩放</td></tr> <tr><td>设置调试程序</td> <td>android.permission.SET_DEBUG_APP</td> <td>设置调试程序</td></tr> <tr><td>设置屏幕方向</td> <td>android.permission.SET_ORIENTATION</td> <td>设置屏幕方向为横屏或标准方式显示</td></tr> <tr><td>设置应用参数</td> <td>android.permission.SET_PREFERRED_APPLICATIONS</td> <td>设置应用的参数</td></tr> <tr><td>设置进程限制</td> <td>android.permission.SET_PROCESS_LIMIT</td> <td>允许程序设置最大的进程数量的限制</td></tr> <tr><td>设置系统时间</td> <td>android.permission.SET_TIME</td> <td>设置系统时间</td></tr> <tr><td>设置系统时区</td> <td>android.permission.SET_TIME_ZONE</td> <td>设置系统时区</td></tr> <tr><td>设置桌面壁纸</td> <td>android.permission.SET_WALLPAPER</td> <td>设置桌面壁纸</td></tr> <tr><td>设置壁纸建议</td> <td>android.permission.SET_WALLPAPER_HINTS</td> <td>设置壁纸建议</td></tr> <tr><td>发送永久进程信号</td> <td>android.permission.SIGNAL_PERSISTENT_PROCESSES</td> <td>发送一个永久的进程信号</td></tr> <tr><td>状态栏控制</td> <td>android.permission.STATUS_BAR</td> <td>允许程序打开、关闭、禁用状态栏</td></tr> <tr><td>访问订阅内容</td> <td>android.permission.SUBSCRIBED_FEEDS_READ</td> <td>访问订阅信息的数据库</td></tr> <tr><td>写入订阅内容</td> <td>android.permission.SUBSCRIBED_FEEDS_WRITE</td> <td>写入或修改订阅内容的数据库</td></tr> <tr><td>显示系统窗口</td> <td>android.permission.SYSTEM_ALERT_WINDOW</td> <td>显示系统窗口</td></tr> <tr><td>更新设备状态</td> <td>android.permission.UPDATE_DEVICE_STATS</td> <td>更新设备状态</td></tr> <tr><td>使用证书</td> <td>android.permission.USE_CREDENTIALS</td> <td>允许程序请求验证从 AccountManager</td></tr> <tr><td>使用 SIP 视频</td> <td>android.permission.USE_SIP</td> <td>允许程序使用 SIP 视频服务</td></tr> <tr><td>使用振动</td> <td>android.permission.VIBRATE</td> <td>允许振动</td></tr> <tr><td>唤醒锁定</td> <td>android.permission.WAKE_LOCK</td> <td>允许程序在手机屏幕关闭后后台进程仍然运行</td></tr> <tr><td>写入 GPRS 接入点设置</td> <td>android.permission.WRITE_APN_SETTINGS</td> <td>写入网络 GPRS 接入点设置</td></tr> <tr><td>写入日程提醒</td> <td>android.permission.WRITE_CALENDAR</td> <td>写入日程</td></tr> <tr><td>写入联系人</td> <td>android.permission.WRITE_CONTACTS</td> <td>写入联系人</td></tr> <tr><td>写入外部存储</td> <td>android.permission.WRITE_EXTERNAL_STORAGE</td> <td>允许程序写入外部存储</td></tr> <tr><td>写入 Google 地图数据</td> <td>android.permission.WRITE_GSERVICES</td> <td>允许程序写入 Google Map 服务数据</td></tr> <tr><td>写入收藏夹和历史记录</td> <td>android.browser.permission.WRITE_HISTORY_BOOKMARKS</td> <td>写入浏览器历史记录或收藏夹</td></tr> <tr><td>读写系统敏感设置</td> <td>android.permission.WRITE_SECURE_SETTINGS</td> <td>允许程序读写系统安全敏感的设置项</td></tr> <tr><td>读写系统设置</td> <td>android.permission.WRITE_SETTINGS</td> <td>允许读写系统设置项</td></tr> <tr><td>编写短信</td> <td>android.permission.WRITE_SMS</td> <td>允许编写短信</td></tr> <tr><td>写入在线同步设置</td> <td>android.permission.WRITE_SYNC_SETTINGS</td> <td>写入 Google 在线同步设置</td></tr></tbody></table> <h2 id="案例展示"><a href="#案例展示" class="header-anchor">#</a> 案例展示</h2> <p>由于方法很多，就简单的预览一下部分方法的页面效果。</p> <ul><li>h5 端效果</li></ul> <p><img src="/img/uniapp-21-methods-h5.gif" alt="h5 端效果"></p> <p><img src="/img/uniapp-21-methods-h5-notify.png" alt="h5 端通知效果"></p> <ul><li>小程序端效果</li></ul> <p><img src="/img/uniapp-21-methods-mnp.gif" alt="小程序端效果"></p> <ul><li>APP 端效果</li></ul> <p><img src="/img/uniapp-21-methods-app.gif" alt="APP 端效果"></p> <h2 id="最后"><a href="#最后" class="header-anchor">#</a> 最后</h2> <p>以上就是日常开发方法汇总的主要内容有不足之处请多多指正。</p></div> <div class="blog-copyright" data-v-626190c6><p data-v-626190c6>版权声明：博客内容遵循 <a target="_blank" href="http://creativecommons.org/licenses/by/4.0/" data-v-626190c6>署名-非商业性使用-相同方式共享 4.0 国际 (CC BY-NC-SA 4.0) 协议</a></p> <p data-v-626190c6>本文永久链接是：<a target="_blank" href="" data-v-626190c6></a></p> <p data-v-626190c6>如需转载，请注明<strong data-v-626190c6>《》</strong>转自<a target="_blank" href="" data-v-626190c6><strong data-v-626190c6></strong></a>，原作者<strong data-v-626190c6></strong></p></div> <div class="blog-share" data-v-1a6a8514><p data-v-1a6a8514>分享至：</p> <ul data-v-1a6a8514><li data-v-1a6a8514><img src="/img/share/qq.png" alt="qq" title="qq" data-v-1a6a8514></li><li data-v-1a6a8514><img src="/img/share/qzone.png" alt="qq空间" title="qq空间" data-v-1a6a8514></li><li data-v-1a6a8514><img src="/img/share/weibo.png" alt="微博" title="微博" data-v-1a6a8514></li><li data-v-1a6a8514><img src="/img/share/douban.png" alt="豆瓣" title="豆瓣" data-v-1a6a8514></li><li data-v-1a6a8514><img src="/img/share/tieba.png" alt="贴吧" title="贴吧" data-v-1a6a8514></li></ul></div> <footer><hr></footer> <div class="blog-comment" data-v-3630b106><div class="giscus" data-v-3630b106></div> <script src="https://giscus.app/client.js" data-repo="gitguanqi/gitguanqi.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxNTkzNDQxMTg=" data-category="Announcements" data-category-id="DIC_kwDOCX9l9s4CRntk" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous" interest-cohort="true" async="async" data-v-3630b106></script></div></article> <div class="sticker vuepress-toc"><div class="vuepress-toc-item vuepress-toc-h2 active"><a href="#目录" title="目录">目录</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#路由拦截" title="路由拦截">路由拦截</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#数据处理" title="数据处理">数据处理</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#敏感词过滤替换方法" title="敏感词过滤替换方法">敏感词过滤替换方法</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#js-打字效果实现" title="JS 打字效果实现">JS 打字效果实现</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#获取-dom-元素" title="获取 DOM 元素">获取 DOM 元素</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#文本转换" title="文本转换">文本转换</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#html-标签转为文本" title="html 标签转为文本">html 标签转为文本</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#生成-uuid" title="生成 uuid">生成 uuid</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#复制文本" title="复制文本">复制文本</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#是否-json" title="是否 JSON">是否 JSON</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#禁用手势" title="禁用手势">禁用手势</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#页面设置" title="页面设置">页面设置</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#配置设置" title="配置设置">配置设置</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#全局设置" title="全局设置">全局设置</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#事件控制" title="事件控制">事件控制</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#系统通知" title="系统通知">系统通知</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#缓存管理" title="缓存管理">缓存管理</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#获取清除方法" title="获取清除方法">获取清除方法</a></div><div class="vuepress-toc-item vuepress-toc-h3"><a href="#缓存案例展示" title="缓存案例展示">缓存案例展示</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#权限列表" title="权限列表">权限列表</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#案例展示" title="案例展示">案例展示</a></div><div class="vuepress-toc-item vuepress-toc-h2"><a href="#最后" title="最后">最后</a></div></div></div></div> <footer class="footer" data-v-d2f94b98><div class="footer-left-wrap" data-v-d2f94b98><ul class="contact" data-v-d2f94b98><li class="contact-item" data-v-d2f94b98><a href="mailto:contact@guanqi.xyz" class="nav-link external" data-v-d2f94b98><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail" data-v-d2f94b98><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" data-v-d2f94b98></path><polyline points="22,6 12,13 2,6" data-v-d2f94b98></polyline></svg>
          
        </a></li><li class="contact-item" data-v-d2f94b98><a href="https://codepen.io/guanqi/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-d2f94b98><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-codepen" data-v-d2f94b98><polygon points="12 2 22 8.5 22 15.5 12 22 2 15.5 2 8.5 12 2" data-v-d2f94b98></polygon><line x1="12" y1="22" x2="12" y2="15.5" data-v-d2f94b98></line><polyline points="22 8.5 12 15.5 2 8.5" data-v-d2f94b98></polyline><polyline points="2 15.5 12 8.5 22 15.5" data-v-d2f94b98></polyline><line x1="12" y1="2" x2="12" y2="8.5" data-v-d2f94b98></line></svg>
          
        </a></li><li class="contact-item" data-v-d2f94b98><a href="https://github.com/gitguanqi/" target="_blank" rel="noopener noreferrer" class="nav-link external" data-v-d2f94b98><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github" data-v-d2f94b98><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22" data-v-d2f94b98></path></svg>
          
        </a></li></ul></div> <div class="footer-right-wrap" data-v-d2f94b98><ul class="copyright" data-v-d2f94b98><li class="copyright-item" data-v-d2f94b98>Copyright © 2017-2024 MarkGuan</li></ul></div> <div class="blog-gotop" data-v-01fd9569 data-v-d2f94b98><div class="blog-header-top" data-v-01fd9569><span data-v-01fd9569></span></div> <div class="blog-gotop" data-v-01fd9569><i class="blog blog-rocket" data-v-01fd9569></i></div></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.5ea0c819.js" defer></script><script src="/assets/js/4.5225e1f1.js" defer></script><script src="/assets/js/1.42b4752f.js" defer></script><script src="/assets/js/135.3d5f346a.js" defer></script>
  </body>
</html>
